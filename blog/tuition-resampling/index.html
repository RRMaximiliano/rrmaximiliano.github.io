<!DOCTYPE html>
<html lang="en-us">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="description" content="A blog by Julia Silge">


    <meta property="twitter:site" content="@juliasilge">

<meta property="twitter:title" content="Preprocessing and resampling using #TidyTuesday college data">

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:image" content="/_images/illustrated_blog_avatar.png">

<meta property="twitter:description" content="">

<title>


     Julia Silge - Preprocessing and resampling using #TidyTuesday college data 

</title>
<link rel="canonical" href="/blog/tuition-resampling/">


<style media="screen">
  @font-face {
  font-family: 'Nexa Bold';
  src: url('/fonts/Nexa Bold.otf');
}

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed,
figure, figcaption, footer, header, hgroup,
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
  margin: 0;
  padding: 0;
  border: 0;
  font-size: 100%;
  font: inherit;
  vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure,
footer, header, hgroup, menu, nav, section {
  display: block;
}
body {
  line-height: 1;
}
ol, ul {
  list-style: none;
}
blockquote, q {
  quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
  content: '';
  content: none;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}

*,
*:before,
*:after {
  box-sizing: border-box;
}
a,
a:visited,
a:focus,
a:active {
  text-decoration: none;
}
html {
  height: 100%;
  font-size: 16px;
}
body {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-flex-direction: column;
  -moz-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  -webkit-justify-content: flex-start;
  -moz-justify-content: flex-start;
  -ms-justify-content: flex-start;
  justify-content: flex-start;
  width: 100%;
  min-height: 100%;
  font-weight: 400;
  font-family: 'Helvetica Neue', 'Arial', sans-serif;
  color: #111111;
  line-height: 1.6;
  text-rendering: optimizeLegibility !important;
}
.icon {
  text-rendering: geometricPrecision !important;
}
section {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-justify-content: center;
  -moz-justify-content: center;
  -ms-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  width: 100%;
}
.container {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  width: 100%;
}
section.header .container {
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  -webkit-justify-content: center;
  -moz-justify-content: center;
  -ms-justify-content: center;
  justify-content: center;
}
section.header .content {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-flex-direction: column;
  -moz-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
}
section.header .container .logo {
  max-width: 100px;
  margin-left: -2em;
}
section.header .name {
  padding-top: 20px;
  font-size: 28px;
  font-family: 'Nexa Bold', 'Helvetica Neue', 'Arial', sans-serif;
  letter-spacing: -0.005rem;
  text-transform: uppercase;
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: antialiased;
  font-smoothing: antialiased;
  color: #333333;
  color: #555555;
}
section.header nav {
  margin-bottom: 16px;
}
section.header nav ul {
  list-style: none;
  text-align: center;
  display: -webkit-inline-flex;
  display: -moz-inline-flex;
  display: -ms-inline-flexbox;
  display: -ms-inline-flex;
  display: inline-flex;
}
section.header nav ul a {
  margin-left: 6px;
  margin-right: 6px;
}
section.header nav ul a:first-child {
  margin-left: 0;
}
section.header nav ul a:last-child {
  margin-right: 0;
}
section.header nav ul li {
  color: #555555;
  font-weight: 400;
  font-size: 14px;
  text-transform: uppercase;
  font-family: 'Helvetica Neue', 'Arial', sans-serif;
  -webkit-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -moz-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -ms-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -o-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
}
section.header nav ul li:hover {
  color: #111111;
}
section.footer .container {
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  -webkit-justify-content: center;
  -moz-justify-content: center;
  -ms-justify-content: center;
  justify-content: center;
  flex-direction: column-reverse;
  width: 100%;
  text-align: center;
}
section.footer .container a {
  font-size: 14px;
  margin-left: 6px;
  margin-right: 6px;
  opacity: 0.6;
  -webkit-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -moz-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -ms-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -o-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
}
section.footer .container a:first-child {
  margin-left: 0;
}
section.footer .container a:last-child {
  margin-right: 0;
}
section.footer .container a:hover {
  opacity: 0.8;
}
section.footer .container a .icon {
  width: 16px;
  height: 16px;
}
section.footer .container .copyright {
  flex-grow: 0.5;
  text-align: start;
}
section.footer .container .icons {
  flex-grow: 0.5;
  text-align: end;
}
section.main .container {
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  -webkit-justify-content: flex-start;
  -moz-justify-content: flex-start;
  -ms-justify-content: flex-start;
  justify-content: flex-start;
}
section.main .content {
  color: #111111;
  font-size: 16px;
}
section.main .content .title-container {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-justify-content: space-between;
  -moz-justify-content: space-between;
  -ms-justify-content: space-between;
  justify-content: space-between;
}
section.main .content .posts {
  margin-bottom: 4em;
}
section.main .content .page-heading {
  font-size: 20px;
  font-weight: 700;
  font-family: 'Helvetica Neue', 'Arial', sans-serif;
  letter-spacing: -0.005rem;
  text-transform: uppercase;
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: antialiased;
  font-smoothing: antialiased;
  color: #333333;
  margin-bottom: 16px;
}
section.main .content .front-matter .page-heading {
  margin-bottom: 0;
}
section.main .content .front-matter .meta {
  font-size: 14px;
  color: #666666;
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  margin-bottom: 32px;
}
section.main .content .front-matter .date,
section.main .content .front-matter .author,
section.main .content .front-matter .tags,
section.main .content .front-matter .word-count,
section.main .content .front-matter .reading-time .middot {
  display: none;
}
section.main .content .front-matter .middot {
  font-size: 6px;
  margin: 0 6px;
  display: inline;
  vertical-align: middle;
}
section.main .content .front-matter .middot:before {
  content: "‚Ä¢";
}
section.main .content .front-matter .tags ul {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-flex-direction: row;
  -moz-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
}
section.main .content .front-matter .tags ul li {
  -webkit-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -moz-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -ms-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -o-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
}
section.main .content .front-matter .tags ul li:hover {
  opacity: 0.7;
}
section.main .content .front-matter .tags ul li a {
  color: #666666;
}
section.main .container.f04 {
  -webkit-justify-content: center;
  -moz-justify-content: center;
  -ms-justify-content: center;
  justify-content: center;
}
section.main .container.f04 .content {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-flex-direction: column;
  -moz-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
}
section.main .container.f04 .content .num {
  margin: 30px 0px 30px 0;
  font-weight: 400;
  font-family: 'Helvetica Neue', 'Arial', sans-serif;
  font-size: 50px;
}
section.main .container.f04 .content .detail {
  margin-bottom: 40px;
}
section.main .container .content .groupby {
  margin-top: 1em;
  padding-left: 0.5em;
}
section.main .container .content .post-item {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  display: list-item;
  list-style: disc inside;
}
section.main .container .content .post-item .meta {
  font-size: 14px;
  color: #666666;
  display: none;
  min-width: 100px;
}
section.main .container .content .see-more {
  font-style: italic;
  float: right;
  font-size: 0.9em;
  margin-top: 2em;
  color: #313537;
}
section.main .container .content .see-more:hover {
  color: #666;
}
section {
  padding: 0 16px;
}
section.header {
  padding-top: 10px;
}
section.header-home {
  padding-top: 36px;
}
section.main {
  padding-top: 32px;
}
section.main .container .content .post-item .meta {
    display: block;
}
section.main .container .content .post-item {
    display: flex;
    list-style: none;
}
a {
  color: #428bca;
  -webkit-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -moz-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -ms-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -o-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
}
a:hover {
  color: #2a6496;
}
img {
  max-width: 100%;
}
section.main .content {
    width: 100%;
}
section.main .content .markdown {
  font-size: 1.1em;
  line-height: 1.75em;
  color: #313537;
  font-family: serif;
  font-weight: 300;
}
section.main .content .markdown h1,
section.main .content .markdown h2,
section.main .content .markdown h3,
section.main .content .markdown h4,
section.main .content .markdown h5,
section.main .content .markdown h6 {
  font-size: 22px;
  font-family: 'Helvetica Neue', 'Arial', sans-serif;
  letter-spacing: -0.005rem;
  font-weight: 700;
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: antialiased;
  font-smoothing: antialiased;
  color: #333333;
  text-transform: none;
  margin-top: 1.75rem;
}
section.main .content .markdown h1 {
  font-size: 1.75rem;
  margin-bottom: 2rem;
}
section.main .content .markdown h2 {
  font-size: 1.5rem;
  margin-bottom: 1.5rem;
}
section.main .content .markdown h3 {
  font-size: 1em;
  margin-bottom: 1rem;
}
section.main .content .markdown h4,
section.main .content .markdown h5,
section.main .content .markdown h6 {
  font-size: 1rem;
  margin-bottom: 1rem;
  letter-spacing: none;
}
section.main .content .markdown code,
section.main .content .markdown pre {
  font-family: 'Menlo', monospace;
  font-size: 0.98rem;
  background-color: #f7f7f7;
}
section.main .content .markdown code {
  /* enclosed by single backtick (`) */
  padding: .15em .5em;
  border-radius: 2px;
}
section.main .content .markdown pre {
  /* Hugo specific: consider using the 'highlight' shortcode */
  display: block;
  margin-top: 1rem;
  margin-bottom: 2rem;
  padding: 1rem;
  line-height: 1.5em;
  white-space: pre;
  word-break: break-all;
  word-wrap: break-word;
}
@media (min-width: 769px) {
  section.main .content .markdown pre {
    width: 110%;
    margin-left: -4%;
  }
}
section.main .content .markdown pre code {
  /* enclosed by 4 backticks (````) */
  padding: 0;
  font-size: 0.9rem;
}
section.main .content .markdown a code {
  color: #428bca !important;
}
section.main .content .markdown a code:hover {
  text-decoration: underline;
}
section.main .content .markdown p {
  text-align: justify;
  margin-top: 0;
  margin-bottom: 1em;
}
section.main .content .markdown ul,
section.main .content .markdown ol,
section.main .content .markdown dl {
  margin-top: 1rem;
  margin-bottom: 2rem;
}
section.main .content .markdown dt {
  font-weight: bold;
}
section.main .content .markdown dd {
  margin-bottom: .5rem;
}
section.main .content .markdown ul {
  list-style-type: disc;
  list-style-position: outside;
  margin-bottom: 1.25rem;
}
section.main .content .markdown ol {
  list-style-type: decimal;
  margin-bottom: 1.25rem;
}
section.main .content .markdown li {
  margin-left: 2em;
}
section.main .content .markdown em {
  font-style: italic;
}
section.main .content .markdown strong {
  font-weight: 700;
}
section.main .content .markdown hr {
  position: relative;
  margin: 1.75rem 0;
  border: 0;
  border-top: 1px solid #808080;
  border-top: 1px solid #999999;
}
section.main .content .markdown abbr {
  font-size: 0.85rem;
  font-weight: bold;
  color: #666666;
  text-transform: uppercase;
}
section.main .content .markdown abbr[title] {
  cursor: help;
  border-bottom: 1px dotted #808080;
}
section.main .content .markdown blockquote {
  padding: .5rem 1rem;
  margin: .8rem 0;
  color: #7a7a7a;
  border-left: .25rem solid #e5e5e5;
}
section.main .content .markdown blockquote p:last-child {
  margin-bottom: 0;
}
section.main .content .markdown figure {
  width: 100%;
  background: #fff;
  margin-bottom: 1em;
}
section.main .content .markdown figure img {
  width: 100%;
  height: auto;
  max-width: 100%;
  display: block;
  position: static;
  margin: auto;
}
section.main .content .markdown table {
  margin-bottom: 1rem;
  width: 100%;
  border: 1px solid #e5e5e5;
  border-collapse: collapse;
}
section.main .content .markdown td,
section.main .content .markdown th {
  padding: .25rem .5rem;
  border: 1px solid #e5e5e5;
}
section.main .content .markdown tbody tr:nth-child(odd) td,
section.main .content .markdown tbody tr:nth-child(odd) th {
  background-color: #f7f7f7;
}
section.main .content .markdown .footnotes ol {
  list-style-type: decimal;
  margin-left: 16px;
}
section.main .content .markdown .footnotes li {
  list-style-type: unset;
}
section.main .content .markdown .footnote-ref {
  font-size: 0.7em;
}
section.main .content .navigation {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-flex-direction: column;
  -moz-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
}
section.main .content .navigation div {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-flex-direction: row;
  -moz-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  margin-top: 1em;
}
section.main .content .navigation .icon {
  width: 16px;
  height: 16px;
}
section.main .content .navigation a {
  width: 250px;
  margin-left: 1em;
  text-align: center;
  font-style: italic;
  color: #313537;
}

/* Fonts */

.wf-raleway-n4-active body, 
.wf-raleway-n4-active section.header nav ul li,
.wf-raleway-n7-active section.main .content .page-heading,
.wf-raleway-n2-active section.main .container.f04 .content .num,
.wf-raleway-n7-active section.main .content .markdown h1,
.wf-raleway-n7-active section.main .content .markdown h2,
.wf-raleway-n7-active section.main .content .markdown h3,
.wf-raleway-n7-active section.main .content .markdown h4,
.wf-raleway-n7-active section.main .content .markdown h5,
.wf-raleway-n7-active section.main .content .markdown h6 {
  font-family: 'Raleway';
}

.wf-merriweather-n3-active section.main .content .markdown {
  font-family: 'Merriweather';
}

.wf-ubuntu-mono-n4-active section.main .content .markdown code,
.wf-ubuntu-mono-n4-active section.main .content .markdown pre {
  font-family: 'Ubuntu Mono';
}
</style>
<style media="(min-width: 600px)">
  body {
-webkit-justify-content: center;
-moz-justify-content: center;
-ms-justify-content: center;
justify-content: center;
}
.non-narrow.zero-top-spacing {
padding-top: 0 !important;
}
section {
padding: 0 16px;
margin-left: 100px;
margin-right: 100px;
max-width: 750px;
}
section.header {
background-color: transparent;
}
section.header .container {
-webkit-justify-content: flex-start;
-moz-justify-content: flex-start;
-ms-justify-content: flex-start;
justify-content: flex-start;
}
section.header .container .logo {
margin: 0;
}
section.header-home .container .logo {
max-width: 180px;
margin-left: 20px;
}
section.header-home .name-home {
padding-top: 30px;
font-size: 40px;
}
section.header-home nav ul li {
font-size: 18px;
}
section.header .content {
-webkit-align-items: flex-start;
-moz-align-items: flex-start;
-ms-align-items: flex-start;
align-items: flex-start;
}
section.header .name {
color: #333333;
}
section.header nav {
font-size: 14px;
margin-bottom: 0;
}
section.header nav ul {
text-align: left;
}
section.header nav ul li {
color: #666666;
}
section.header nav ul li:hover {
color: #333333;
}
section.footer {
background-color: transparent;
}
section.footer .container {
flex-direction: row;
}
section.footer .container a {
margin-left: 3px;
margin-right: 3px;
color: #666666;
}
section.footer .container a:hover {
color: #333333;
}
section.footer .container a .icon {
font-size: 18px;
}
section.footer .container a .icon.larger {
font-size: 20px;
}
section.main .content .front-matter .date,
section.main .content .front-matter .author,
section.main .content .front-matter .tags,
section.main .content .front-matter .word-count,
section.main .content .front-matter .reading-time .middot {
display: initial;
}
section.main .container.f04 {
-webkit-justify-content: flex-start;
-moz-justify-content: flex-start;
-ms-justify-content: flex-start;
justify-content: flex-start;
}
section.main .container.f04 .content {
-webkit-align-items: flex-start;
-moz-align-items: flex-start;
-ms-align-items: flex-start;
align-items: flex-start;
}
section.main .container.f04 .content .num {
margin: 0 0 10px 0;
font-size: 32px;
}
section.main .container.f04 .content .detail {
margin-bottom: 30px;
}
.container {
padding: 0 30px;
}
section.header {
padding-top: 60px;
padding-bottom: 60px;
}
section.footer {
padding-top: 30px;
padding-bottom: 60px;
}
section.main {
padding-top: 0;
}
section.main .container .content .post-item {
display: flex;
list-style: none;
padding-left: 1.5em;
}
section.main .container .content .post-item .meta {
display: block;
}
section.main.post {
padding-top: 60px;
padding-bottom: 60px;
}
section.main .content .markdown blockquote {
padding-right: 5rem;
padding-left: 1.25rem;
}
section.main .content .navigation {
-webkit-flex-direction: row;
-moz-flex-direction: row;
-ms-flex-direction: row;
flex-direction: row;
}
section.main .content .navigation div {
margin-top: 0em;
}
</style>
<style media="(min-width: 769px)">
  section.main .content .markdown figure {
width: 110%;
margin-left: -4%;
}
section.main .content .markdown img {
max-width: 110%;
width: 110%;
margin-left: -4%;
}
</style>

<noscript>
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,600,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Merriweather:300,300i,700,700i" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700" rel="stylesheet">
</noscript>


  <style type="text/css" media="screen">
    .hljs{display:block;background:white;padding:0.5em;color:#333333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-string,.hljs-variable,.hljs-template-variable,.hljs-strong,.hljs-emphasis,.hljs-quote{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-literal,.hljs-symbol,.hljs-bullet,.hljs-attribute{color:#0086b3}.hljs-section,.hljs-name{color:#63a35c}.hljs-tag{color:#333333}.hljs-title,.hljs-attr,.hljs-selector-id,.hljs-selector-class,.hljs-selector-attr,.hljs-selector-pseudo{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}
  </style>



  <style type="text/css" media="screen">
    .progressive{overflow:hidden;position:relative;background:#efefef}.progressive__img{width:100%;height:100%;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0)}.progressive--not-loaded{filter:blur(30px);-webkit-filter:blur(30px)}.progressive--is-loaded{filter:blur(20px);-webkit-filter:blur(20px);-webkit-animation:sharpen .5s both;animation:sharpen .5s both}@-webkit-keyframes sharpen{from{filter:blur(20px);-webkit-filter:blur(20px)}to{filter:blur(0);-webkit-filter:blur(0)}}@keyframes sharpen{from{filter:blur(20px);-webkit-filter:blur(20px)}to{filter:blur(0);-webkit-filter:blur(0)}}
  </style>







<link rel="shortcut icon"

    href="/_images/favicon.ico"

>




</head>


<body>


<section class="header">

    <div class="container">
        <a href="/"><img class="logo" src="/_images/illustrated_blog_avatar.png" alt="logo" /></a>
        <div class="content">
            <a href="/"><div class="name"><h1>Julia Silge</h1></div></a>
            <nav>
                <ul>
                    
                        <a href="/blog/"><li>Blog</li></a>
                    
                    
                        
                            
                        
                    
                    
                        
                            <a href="/about/"><li>about</li></a>
                        
                    
                        
                            <a href="/resume/"><li>resume</li></a>
                        
                    
                </ul>
            </nav>
        </div>
    </div>
</section>


<section class="main post non-narrow zero-top-spacing">
    <div class="container">
        <div class="content">
            <div class="front-matter">
                <div class="title-container">
                    <div class="page-heading">

    Preprocessing and resampling using #TidyTuesday college data

</div>

                </div>
                <div class="meta">
                    <div class="date" title="Tue Mar 10 2020 00:00:00 UTC">Mar 10, 2020</div>
                    
                        
                    
                    <div class="reading-time"><div class="middot"></div>11 minute read</div>
                    <div class="tags">
                        <ul>
                          
                            <div class="middot"></div>
                            <li><a href="/tags/rstats">rstats</a> </li>
                          
                            <div class="middot"></div>
                            <li><a href="/tags/tidymodels">tidymodels</a> </li>
                          
                        </ul>
                    </div>
                </div>
            </div>
            <div class="markdown">
                
    
    


<p>I‚Äôve been publishing <a href="https://juliasilge.com/tags/tidymodels/">screencasts</a> demonstrating how to use the tidymodels framework, from first getting started to how to tune machine learning models. Today, I‚Äôm using this week‚Äôs <a href="https://github.com/rfordatascience/tidytuesday"><code>#TidyTuesday</code> dataset</a> on college tuition and diversity at US colleges to show some data preprocessing steps and how to use resampling!</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/s3TkvZM60iU" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<p></br></p>
<p>Here is the code I used in the video, for those who prefer reading instead of or in addition to video.</p>
<div id="explore-the-data" class="section level2">
<h2>Explore the data</h2>
<p>Our modeling goal here is to predict which US colleges have higher proportions of minority students based on college data such as tuition from the <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-03-10/readme.md">#TidyTuesday dataset</a>. There are several related datasets this week, and this modeling analysis uses two of them.</p>
<pre class="r"><code>library(tidyverse)

tuition_cost &lt;- readr::read_csv(&quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_cost.csv&quot;)

diversity_raw &lt;- readr::read_csv(&quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/diversity_school.csv&quot;) %&gt;%
  filter(category == &quot;Total Minority&quot;) %&gt;%
  mutate(TotalMinority = enrollment / total_enrollment)</code></pre>
<p>What is the distribution of total minority student population?</p>
<pre class="r"><code>diversity_school &lt;- diversity_raw %&gt;%
  filter(category == &quot;Total Minority&quot;) %&gt;%
  mutate(TotalMinority = enrollment / total_enrollment)

diversity_school %&gt;%
  ggplot(aes(TotalMinority)) +
  geom_histogram(alpha = 0.7, fill = &quot;midnightblue&quot;) +
  scale_x_continuous(labels = scales::percent_format()) +
  labs(x = &quot;% of student population who identifies as any minority&quot;)</code></pre>
<p><img src="/blog/2020/2020-03-10-tuition-resampling_files/figure-html/unnamed-chunk-3-1.png" width="2400" /></p>
<p>The median proportion of minority students for this dataset is 30%.</p>
<p>Let‚Äôs build a dataset for modeling, joining the two dataframes we have. Let‚Äôs also move from individual states in the US to US regions, as found in <code>state.region</code>.</p>
<pre class="r"><code>university_df &lt;- diversity_school %&gt;%
  filter(category == &quot;Total Minority&quot;) %&gt;%
  mutate(TotalMinority = enrollment / total_enrollment) %&gt;%
  transmute(
    diversity = case_when(
      TotalMinority &gt; 0.3 ~ &quot;high&quot;,
      TRUE ~ &quot;low&quot;
    ),
    name, state,
    total_enrollment
  ) %&gt;%
  inner_join(tuition_cost %&gt;%
    select(
      name, type, degree_length,
      in_state_tuition:out_of_state_total
    )) %&gt;%
  left_join(tibble(state = state.name, region = state.region)) %&gt;%
  select(-state, -name) %&gt;%
  mutate_if(is.character, factor)

skimr::skim(university_df)</code></pre>
<pre><code>## ‚îÄ‚îÄ Data Summary ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
##                            Values       
## Name                       university_df
## Number of rows             2159         
## Number of columns          9            
## _______________________                 
## Column type frequency:                  
##   factor                   4            
##   numeric                  5            
## ________________________                
## Group variables            None         
## 
## ‚îÄ‚îÄ Variable type: factor ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
##   skim_variable n_missing complete_rate ordered n_unique
## 1 diversity             0             1 FALSE          2
## 2 type                  0             1 FALSE          3
## 3 degree_length         0             1 FALSE          2
## 4 region                0             1 FALSE          4
##   top_counts                            
## 1 low: 1241, hig: 918                   
## 2 Pub: 1145, Pri: 955, For: 59          
## 3 4 Y: 1296, 2 Y: 863                   
## 4 Sou: 774, Nor: 543, Nor: 443, Wes: 399
## 
## ‚îÄ‚îÄ Variable type: numeric ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
##   skim_variable        n_missing complete_rate   mean     sd    p0   p25   p50
## 1 total_enrollment             0             1  6184.  8264.    15  1352  3133
## 2 in_state_tuition             0             1 17044. 15461.   480  4695 10161
## 3 in_state_total               0             1 23545. 19782.   962  5552 17749
## 4 out_of_state_tuition         0             1 20798. 13725.   480  9298 17045
## 5 out_of_state_total           0             1 27299. 18221.  1376 11018 23036
##      p75  p100 hist 
## 1  7644. 81459 ‚ñá‚ñÅ‚ñÅ‚ñÅ‚ñÅ
## 2 28780  59985 ‚ñá‚ñÇ‚ñÇ‚ñÅ‚ñÅ
## 3 38519  75003 ‚ñá‚ñÖ‚ñÇ‚ñÇ‚ñÅ
## 4 29865  59985 ‚ñá‚ñÜ‚ñÖ‚ñÇ‚ñÅ
## 5 40154  75003 ‚ñá‚ñÖ‚ñÖ‚ñÇ‚ñÅ</code></pre>
<p>How are some of these quantities related to the proportion of minority students at a college?</p>
<pre class="r"><code>university_df %&gt;%
  ggplot(aes(type, in_state_tuition, fill = diversity)) +
  geom_boxplot(alpha = 0.8) +
  scale_y_continuous(labels = scales::dollar_format()) +
  labs(x = NULL, y = &quot;In-State Tuition&quot;, fill = &quot;Diversity&quot;)</code></pre>
<p><img src="/blog/2020/2020-03-10-tuition-resampling_files/figure-html/unnamed-chunk-5-1.png" width="2400" /></p>
</div>
<div id="build-models-with-recipes" class="section level2">
<h2>Build models with recipes</h2>
<p>Now it is time for modeling! First, we split our data into training and testing sets. Then, we build a recipe for data preprocessing.</p>
<ul>
<li>First, we must tell the <code>recipe()</code> what our model is going to be (using a formula here) and what our training data is.</li>
<li>We then filter out variables that are too correlated with each other. We had several different ways of measuring the tuition in our dataset that are correlated with each other, and this step shows how to handle a situation like that.</li>
<li>We then convert the factor columns into (one or more) numeric binary (0 and 1) variables for the levels of the training data.</li>
<li>Next, we remove any numeric variables that have zero variance.</li>
<li>As a last step, we normalize (center and scale) the numeric variables. We need to do this because some of them are on very different scales from each other and a model we want to train is sensitive to this.</li>
<li>Finally, we <code>prep()</code> the <code>recipe()</code>. This means we actually do something with the steps and our training data; we estimate the required parameters from <code>uni_train</code> to implement these steps so this whole sequence can be applied later to another dataset.</li>
</ul>
<pre class="r"><code>library(tidymodels)

set.seed(1234)
uni_split &lt;- initial_split(university_df, strata = diversity)
uni_train &lt;- training(uni_split)
uni_test &lt;- testing(uni_split)

uni_rec &lt;- recipe(diversity ~ ., data = uni_train) %&gt;%
  step_corr(all_numeric()) %&gt;%
  step_dummy(all_nominal(), -all_outcomes()) %&gt;%
  step_zv(all_numeric()) %&gt;%
  step_normalize(all_numeric())

uni_prep &lt;- uni_rec %&gt;%
  prep()

uni_prep</code></pre>
<pre><code>## Data Recipe
## 
## Inputs:
## 
##       role #variables
##    outcome          1
##  predictor          8
## 
## Training data contained 1620 data points and no missing data.
## 
## Operations:
## 
## Correlation filter removed in_state_tuition, ... [trained]
## Dummy variables from type, degree_length, region [trained]
## Zero variance filter removed no terms [trained]
## Centering and scaling for total_enrollment, ... [trained]</code></pre>
<p>Now it‚Äôs time to <strong>specify</strong> and then <strong>fit</strong> our models. Here, we specify and fit three models:</p>
<ul>
<li>logistic regression</li>
<li>k-nearest neighbor</li>
<li>decision tree</li>
</ul>
<p>Check out what data we are training these models on: <code>juice(uni_rec)</code>. The recipe <code>uni_rec</code> contains all our transformations for data preprocessing and feature engineering, <em>as well as</em> the data these transformations were estimated from. When we <code>juice()</code> the recipe, we squeeze that training data back out, transformed in all the ways we specified.</p>
<pre class="r"><code>uni_juiced &lt;- juice(uni_prep)

glm_spec &lt;- logistic_reg() %&gt;%
  set_engine(&quot;glm&quot;)

glm_fit &lt;- glm_spec %&gt;%
  fit(diversity ~ ., data = uni_juiced)

glm_fit</code></pre>
<pre><code>## parsnip model object
## 
## Fit time:  9ms 
## 
## Call:  stats::glm(formula = formula, family = stats::binomial, data = data)
## 
## Coefficients:
##           (Intercept)       total_enrollment     out_of_state_total  
##                0.3704                -0.4581                 0.5074  
##          type_Private            type_Public  degree_length_X4.Year  
##               -0.1656                 0.2058                 0.2082  
##          region_South   region_North.Central            region_West  
##               -0.5175                 0.3004                -0.5363  
## 
## Degrees of Freedom: 1619 Total (i.e. Null);  1611 Residual
## Null Deviance:       2210 
## Residual Deviance: 1859  AIC: 1877</code></pre>
<pre class="r"><code>knn_spec &lt;- nearest_neighbor() %&gt;%
  set_engine(&quot;kknn&quot;) %&gt;%
  set_mode(&quot;classification&quot;)

knn_fit &lt;- knn_spec %&gt;%
  fit(diversity ~ ., data = uni_juiced)

knn_fit</code></pre>
<pre><code>## parsnip model object
## 
## Fit time:  66ms 
## 
## Call:
## kknn::train.kknn(formula = formula, data = data, ks = 5)
## 
## Type of response variable: nominal
## Minimal misclassification: 0.3277778
## Best kernel: optimal
## Best k: 5</code></pre>
<pre class="r"><code>tree_spec &lt;- decision_tree() %&gt;%
  set_engine(&quot;rpart&quot;) %&gt;%
  set_mode(&quot;classification&quot;)

tree_fit &lt;- tree_spec %&gt;%
  fit(diversity ~ ., data = uni_juiced)

tree_fit</code></pre>
<pre><code>## parsnip model object
## 
## Fit time:  24ms 
## n= 1620 
## 
## node), split, n, loss, yval, (yprob)
##       * denotes terminal node
## 
##  1) root 1620 689 low (0.4253086 0.5746914)  
##    2) region_North.Central&lt; 0.5346496 1192 586 high (0.5083893 0.4916107)  
##      4) out_of_state_total&lt; -0.7087237 418 130 high (0.6889952 0.3110048) *
##      5) out_of_state_total&gt;=-0.7087237 774 318 low (0.4108527 0.5891473)  
##       10) out_of_state_total&lt; 0.35164 362 180 low (0.4972376 0.5027624)  
##         20) region_South&gt;=0.3002561 212  86 high (0.5943396 0.4056604)  
##           40) degree_length_X4.Year&gt;=-0.2001293 172  62 high (0.6395349 0.3604651) *
##           41) degree_length_X4.Year&lt; -0.2001293 40  16 low (0.4000000 0.6000000) *
##         21) region_South&lt; 0.3002561 150  54 low (0.3600000 0.6400000)  
##           42) region_West&gt;=0.8128302 64  28 high (0.5625000 0.4375000) *
##           43) region_West&lt; 0.8128302 86  18 low (0.2093023 0.7906977) *
##       11) out_of_state_total&gt;=0.35164 412 138 low (0.3349515 0.6650485)  
##         22) region_West&gt;=0.8128302 88  38 high (0.5681818 0.4318182)  
##           44) out_of_state_total&gt;=1.547681 30   5 high (0.8333333 0.1666667) *
##           45) out_of_state_total&lt; 1.547681 58  25 low (0.4310345 0.5689655) *
##         23) region_West&lt; 0.8128302 324  88 low (0.2716049 0.7283951) *
##    3) region_North.Central&gt;=0.5346496 428  83 low (0.1939252 0.8060748)  
##      6) out_of_state_total&lt; -1.19287 17   5 high (0.7058824 0.2941176) *
##      7) out_of_state_total&gt;=-1.19287 411  71 low (0.1727494 0.8272506) *</code></pre>
<p>Models! üéâ</p>
</div>
<div id="evaluate-models-with-resampling" class="section level2">
<h2>Evaluate models with resampling</h2>
<p>Well, we fit models, but how do we evaluate them? We can use resampling to compute performance metrics across some set of resamples, like the cross-validation splits we create here. The function <code>fit_resamples()</code> fits a model such as <code>glm_spec</code> to the analysis subset of each resample and evaluates on the heldout bit (the assessment subset) from each resample. We can use <code>metrics = metric_set()</code> to specify which metrics we want to compute if we don‚Äôt want to only use the default ones; here let‚Äôs check out sensitivity and specificity.</p>
<p>Originally in the video, I set up the resampled folds like this:</p>
<pre class="r"><code>set.seed(123)
folds &lt;- vfold_cv(uni_juiced, strata = diversity)</code></pre>
<p>But some helpful folks pointed out that this can result in overly optimistic results from resampling (i.e.¬†data leakage) because of some of the recipe steps. It‚Äôs better to resample the original training data.</p>
<pre class="r"><code>set.seed(123)
folds &lt;- vfold_cv(uni_train, strata = diversity)</code></pre>
<p>After we have these folds, we can use <code>fit_resamples()</code> with the recipe to estimate model metrics.</p>
<pre class="r"><code>set.seed(234)
glm_rs &lt;- glm_spec %&gt;%
  fit_resamples(
    uni_rec,
    folds,
    metrics = metric_set(roc_auc, sens, spec),
    control = control_resamples(save_pred = TRUE)
  )

set.seed(234)
knn_rs &lt;- knn_spec %&gt;%
  fit_resamples(
    uni_rec,
    folds,
    metrics = metric_set(roc_auc, sens, spec),
    control = control_resamples(save_pred = TRUE)
  )

set.seed(234)
tree_rs &lt;- tree_spec %&gt;%
  fit_resamples(
    uni_rec,
    folds,
    metrics = metric_set(roc_auc, sens, spec),
    control = control_resamples(save_pred = TRUE)
  )</code></pre>
<p>What do these results look like?</p>
<pre class="r"><code>tree_rs</code></pre>
<pre><code>## #  10-fold cross-validation using stratification 
## # A tibble: 10 x 5
##    splits             id     .metrics         .notes           .predictions     
##  * &lt;list&gt;             &lt;chr&gt;  &lt;list&gt;           &lt;list&gt;           &lt;list&gt;           
##  1 &lt;split [1.5K/163]&gt; Fold01 &lt;tibble [3 √ó 3]&gt; &lt;tibble [0 √ó 1]&gt; &lt;tibble [163 √ó 5‚Ä¶
##  2 &lt;split [1.5K/162]&gt; Fold02 &lt;tibble [3 √ó 3]&gt; &lt;tibble [0 √ó 1]&gt; &lt;tibble [162 √ó 5‚Ä¶
##  3 &lt;split [1.5K/162]&gt; Fold03 &lt;tibble [3 √ó 3]&gt; &lt;tibble [0 √ó 1]&gt; &lt;tibble [162 √ó 5‚Ä¶
##  4 &lt;split [1.5K/162]&gt; Fold04 &lt;tibble [3 √ó 3]&gt; &lt;tibble [0 √ó 1]&gt; &lt;tibble [162 √ó 5‚Ä¶
##  5 &lt;split [1.5K/162]&gt; Fold05 &lt;tibble [3 √ó 3]&gt; &lt;tibble [0 √ó 1]&gt; &lt;tibble [162 √ó 5‚Ä¶
##  6 &lt;split [1.5K/162]&gt; Fold06 &lt;tibble [3 √ó 3]&gt; &lt;tibble [0 √ó 1]&gt; &lt;tibble [162 √ó 5‚Ä¶
##  7 &lt;split [1.5K/162]&gt; Fold07 &lt;tibble [3 √ó 3]&gt; &lt;tibble [0 √ó 1]&gt; &lt;tibble [162 √ó 5‚Ä¶
##  8 &lt;split [1.5K/162]&gt; Fold08 &lt;tibble [3 √ó 3]&gt; &lt;tibble [0 √ó 1]&gt; &lt;tibble [162 √ó 5‚Ä¶
##  9 &lt;split [1.5K/162]&gt; Fold09 &lt;tibble [3 √ó 3]&gt; &lt;tibble [0 √ó 1]&gt; &lt;tibble [162 √ó 5‚Ä¶
## 10 &lt;split [1.5K/161]&gt; Fold10 &lt;tibble [3 √ó 3]&gt; &lt;tibble [0 √ó 1]&gt; &lt;tibble [161 √ó 5‚Ä¶</code></pre>
<p>We can use <code>collect_metrics()</code> to see the summarized performance metrics for each set of resamples.</p>
<pre class="r"><code>glm_rs %&gt;%
  collect_metrics()</code></pre>
<pre><code>## # A tibble: 3 x 5
##   .metric .estimator  mean     n std_err
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1 roc_auc binary     0.758    10 0.00891
## 2 sens    binary     0.617    10 0.0179 
## 3 spec    binary     0.737    10 0.00677</code></pre>
<pre class="r"><code>knn_rs %&gt;%
  collect_metrics()</code></pre>
<pre><code>## # A tibble: 3 x 5
##   .metric .estimator  mean     n std_err
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1 roc_auc binary     0.728    10 0.00652
## 2 sens    binary     0.595    10 0.00978
## 3 spec    binary     0.733    10 0.0121</code></pre>
<pre class="r"><code>tree_rs %&gt;%
  collect_metrics()</code></pre>
<pre><code>## # A tibble: 3 x 5
##   .metric .estimator  mean     n std_err
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1 roc_auc binary     0.723    10 0.00578
## 2 sens    binary     0.642    10 0.0182 
## 3 spec    binary     0.745    10 0.00941</code></pre>
<p>In realistic situations, we often care more about one of sensitivity or specificity than overall accuracy.</p>
<p>What does the ROC curve look like for these models?</p>
<pre class="r"><code>glm_rs %&gt;%
  unnest(.predictions) %&gt;%
  mutate(model = &quot;glm&quot;) %&gt;%
  bind_rows(knn_rs %&gt;%
    unnest(.predictions) %&gt;%
    mutate(model = &quot;knn&quot;)) %&gt;%
  bind_rows(tree_rs %&gt;%
    unnest(.predictions) %&gt;%
    mutate(model = &quot;rpart&quot;)) %&gt;%
  group_by(model) %&gt;%
  roc_curve(diversity, .pred_high) %&gt;%
  ggplot(aes(x = 1 - specificity, y = sensitivity, color = model)) +
  geom_line(size = 1.5) +
  geom_abline(
    lty = 2, alpha = 0.5,
    color = &quot;gray50&quot;,
    size = 1.2
  )</code></pre>
<p><img src="/blog/2020/2020-03-10-tuition-resampling_files/figure-html/unnamed-chunk-13-1.png" width="2400" /></p>
<p>If we decide the logistic regression model is the best fit for our purposes, we can look at the parameters in detail.</p>
<pre class="r"><code>glm_fit %&gt;%
  tidy() %&gt;%
  arrange(-estimate)</code></pre>
<pre><code>## # A tibble: 9 x 5
##   term                  estimate std.error statistic  p.value
##   &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 out_of_state_total       0.507    0.0934     5.43  5.58e- 8
## 2 (Intercept)              0.370    0.0572     6.47  9.72e-11
## 3 region_North.Central     0.300    0.0825     3.64  2.72e- 4
## 4 degree_length_X4.Year    0.208    0.0863     2.41  1.58e- 2
## 5 type_Public              0.206    0.193      1.07  2.86e- 1
## 6 type_Private            -0.166    0.197     -0.838 4.02e- 1
## 7 total_enrollment        -0.458    0.0737    -6.22  5.07e-10
## 8 region_South            -0.517    0.0782    -6.62  3.64e-11
## 9 region_West             -0.536    0.0724    -7.41  1.27e-13</code></pre>
<p>Larger, less expensive schools in the South and West are more likely to have higher proportions of minority students.</p>
<p>Finally, we can return to our test data as a last, unbiased check on how we can expect this model to perform on new data. We <code>bake()</code> our recipe using the testing set to apply the same preprocessing steps that we used on the training data.</p>
<pre class="r"><code>glm_fit %&gt;%
  predict(
    new_data = bake(uni_prep, uni_test),
    type = &quot;prob&quot;
  ) %&gt;%
  mutate(truth = uni_test$diversity) %&gt;%
  roc_auc(truth, .pred_high)</code></pre>
<pre><code>## # A tibble: 1 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 roc_auc binary         0.756</code></pre>
<p>We can also explore other metrics with the test set, such as specificity.</p>
<pre class="r"><code>glm_fit %&gt;%
  predict(
    new_data = bake(uni_prep, new_data = uni_test),
    type = &quot;class&quot;
  ) %&gt;%
  mutate(truth = uni_test$diversity) %&gt;%
  spec(truth, .pred_class)</code></pre>
<pre><code>## # A tibble: 1 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 spec    binary         0.719</code></pre>
<p>Our metrics for the test set agree pretty well with what we found from resampling, indicating we had a good estimate of how the model will perform on new data.</p>
</div>


                <br>
            </div>
            
                <div class="navigation">
                    
                    <div>
                        <img class="icon" src="/img/back.svg" alt="back" />
                        <a href="/blog/food-hyperparameter-tune/">Hyperparameter tuning and #TidyTuesday food consumption</a>
                    </div>
                    
                    <div style="width: 100%;"></div>
                    
                    <div>
                        <a href="/blog/lasso-the-office/">LASSO regression using tidymodels and #TidyTuesday data for The Office</a>
                        <img class="icon" src="/img/next.svg" alt="next" />
                    </div>
                    
                </div>
            
            <br>
            <div class="disqus">
                <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "datascienceish" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            </div>
        </div>
    </div>
</section>

<section class="footer">
    <div class="container">
        <div class="copyright">

        
            <a href="/about">Copyright ¬© 2020 Julia Silge</a>
        

        </div>
        <div class="icons">

        
            <a href="https://github.com/juliasilge" target="_blank">
                <img class="icon" src="/img/github.svg" alt="github" />
            </a>
        

        
            <a href="https://twitter.com/juliasilge" target="_blank">
                <img class="icon" src="/img/twitter.svg" alt="twitter" />
            </a>
        

        
            <a href="https://www.linkedin.com/in/juliasilge" target="_blank">
                <img class="icon" src="/img/linkedin.svg" alt="linkedin" />
            </a>
        

        

        
            <a href="/index.xml">
                <img class="icon" src="/img/rss.svg" alt="rss" />
            </a>
        

        </div>
    </div>
</section>

<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
<script>
  WebFont.load({
    google: {
      families: ['Raleway:400,600,700', 'Merriweather:300,300i,700,700i', 'Ubuntu+Mono:400,700']
    }
  });
</script>

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>


  <script src="/js/highlight.min.js" defer></script>
  



  <script src="/js/progressively.min.js" defer></script>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-68765210-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script>
  window.onload = function() {
    
      hljs.initHighlighting();
    
    
      progressively.init({delay: 30, throttle: 50});
    
  };
</script>


</body>
</html>

